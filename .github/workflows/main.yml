name: Build and Check Application
run-name: ${{ github.actor }} is building the application üèóÔ∏è
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "20.x"
      - run: echo "Installing dependencies ‚è¨"
      - run: npm ci
      - run: echo "Building application üë∑"
      - run: npm run build --if-present
      - run: echo "Building is complete ‚úÖ"
      # Serve the application locally
      - name: Serve Application
        run: npx serve -s build &
        # Replace 'npx serve -s build' with the command you use to serve your application locally
      # Health check
      - name: Check if homepage is up
        id: healthcheck
        run: |
          sleep 10 # Give some time for the server to start
          response=$(curl --write-out "%{http_code}" --silent --output /dev/null "http://localhost:5173")
          # Replace 'http://localhost:5173' with the local URL your application is served on
          if [ "$response" -ne 200 ]; then
            echo "::error::Homepage is not up. Response code: $response"
            exit 1
          fi
      - name: Report status
        if: ${{ steps.healthcheck.outcome == 'success' }}
        run: echo "Homepage is up and running ‚úÖ"
